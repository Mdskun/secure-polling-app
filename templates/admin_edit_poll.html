{% extends "base.html" %}
{% block content %}
<h2>{{ 'Edit Poll' if poll else 'Create Poll' }}</h2>
<form method="POST">
    <div class="mb-3">
        <label class="form-label">Question</label>
        <input type="text" name="question" class="form-control" value="{{ poll.question if poll else '' }}" required>
    </div>
    <div class="mb-3">
        <label class="form-label">Start Time (optional)</label>
        <input type="datetime-local" name="start_time" class="form-control" value="{% if poll and poll.start_time %}{{ poll.start_time.strftime('%Y-%m-%dT%H:%M') }}{% endif %}">
    </div>
    <div class="mb-3">
        <label class="form-label">End Time (optional)</label>
        <input type="datetime-local" name="end_time" class="form-control" value="{% if poll and poll.end_time %}{{ poll.end_time.strftime('%Y-%m-%dT%H:%M') }}{% endif %}">
    </div>
    <div id="options">
        {% if poll %}
            {% for opt in poll.options %}
            <div class="mb-3">
                <label class="form-label">Option</label>
                <input type="text" name="options" class="form-control" value="{{ opt.text }}" required>
            </div>
            {% endfor %}
        {% else %}
            <div class="mb-3">
                <label class="form-label">Option 1</label>
                <input type="text" name="options" class="form-control" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Option 2</label>
                <input type="text" name="options" class="form-control" required>
            </div>
        {% endif %}
    </div>
    <button type="button" class="btn btn-secondary mb-3" onclick="addOption()">Add More Option</button>
    <br>
    <button type="submit" class="btn btn-success">{{ 'Update Poll' if poll else 'Create Poll' }}</button>
</form>

<script>
function addOption() {
    const div = document.createElement('div');
    div.className = 'mb-3';
    const label = document.createElement('label');
    label.className = 'form-label';
    label.textContent = 'Option';
    const input = document.createElement('input');
    input.type = 'text';
    input.name = 'options';
    input.className = 'form-control';
    input.required = true;
    div.appendChild(label);
    div.appendChild(input);
    document.getElementById('options').appendChild(div);
}
</script>
{% endblock %}